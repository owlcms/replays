# HTTP server port
port = 8091

# address of owlcms.  a scan of the local network will be done if undefined or unreachable.
owlcms = ""

# Platform identifier if more than one platform detected
platform = "A"

# Directory to store video files (can be an absolute path to store on a different drive)
videoDir = 'videos'

# FFmpeg logging - set to true to create timestamped log files for ffmpeg output
logFfmpeg = false


# =======================================================
# Multicast Camera Configuration
# =======================================================
# When enabled, replays reads H.264 streams from multicast UDP
# (sent by the cameras program) instead of locally-attached cameras.
# Set a port for each camera (0 = unused).

[multicast]
    enabled = true
    ip = "239.255.0.1"
    camera1Port = 9001
    camera2Port = 0
    camera3Port = 0
    camera4Port = 0


# =======================================================
# Windows Camera Configurations
# =======================================================

[windows1]
    description = "Webcam (MJPEG copy, re-encoded on trim)"
    enabled = false
    camera = 'Logitech Webcam C930e'
    format = 'dshow'
    size = "1280x720"
    fps = 30
    
    # Input parameters for the recording
    # Put flags that must come before `-i <camera name>` here.
    inputParameters = '-pixel_format mjpeg -rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: copy MJPEG stream directly (no re-encoding during recording)
    # Put flags that must come after `-i <camera name>` here.
    outputParameters = '-vcodec copy -an'
    
    # When trimming, re-encode to H.264 for browser playback
    recode = true


[windows1b]
    description = "USB Camera with H.264 output (copy, no recode)"
    enabled = false
    camera = 'USB H.264 Camera'
    format = 'dshow'
    size = "1920x1080"
    fps = 30
    
    # Input parameters for the recording
    # Put flags that must come before `-i <camera name>` here.
    inputParameters = '-rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: copy H.264 stream directly (camera outputs H.264)
    # Put flags that must come after `-i <camera name>` here.
    outputParameters = '-c:v copy -an'
    
    # No recoding needed - camera already outputs H.264
    recode = false


[windows2]
    description = "HDMI Camera with AMD GPU"
    enabled = false
    camera = 'HDMI_AMD_GPU'
    format = 'dshow'
    size = "1920x1080"
    fps = 60
    
    # These input parameters prevent the real-time buffer too full error.
    # They must be on the input side (before -i).
    inputParameters = '-rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: produce H.264 output using AMD AMF hardware encoder
    outputParameters = '-c:v h264_amf -rc cbr -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'

    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false

[windows3]
    description = "HDMI Camera with NVIDIA GPU"
    enabled = false
    camera = 'HDMI_NVIDIA_GPU'
    format = 'dshow'
    size = "1920x1080"
    fps = 60
    
    # These input parameters prevent the real-time buffer too full error.
    # They must be on the input side (before -i).
    inputParameters = '-rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: produce H.264 output using NVIDIA hardware encoder
    outputParameters = '-c:v h264_nvenc -preset p5 -rc cbr -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'

    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false

[windows4]
    description = "HDMI Camera with Intel GPU"
    enabled = false
    camera = 'HDMI_INTEL_GPU'
    format = 'dshow'
    size = "1920x1080"
    fps = 60
    
    # QSV init must come first, followed by input parameters
    inputParameters = '-init_hw_device qsv=hw -filter_hw_device hw -rtbufsize 512M -thread_queue_size 4096'

    # Output parameters: produce H.264 output using Intel QSV hardware encoder
    outputParameters = '-c:v h264_qsv -preset medium -look_ahead 0 -rc_mode CBR -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'

    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false


# =======================================================
# Linux Camera Configurations
# =======================================================

[linux1]
    description = "Webcam (MJPEG copy, re-encoded on trim)"
    enabled = false
    camera = '/dev/video0'
    format = 'v4l2'
    size = "1280x720"
    fps = 30
    
    # Input parameters for the recording
    # Put flags that must come before `-i <camera name>` here.
    inputParameters = '-input_format mjpeg -rtbufsize 512M -thread_queue_size 4096'

    # Output parameters: copy MJPEG stream directly (no re-encoding during recording)
    # Put flags that must come after `-i <camera name>` here.
    outputParameters = '-vcodec copy -an'
    
    # When trimming, re-encode to H.264 for browser playback
    recode = true


[linux1b]
    description = "USB Camera with H.264 output (copy, no recode)"
    enabled = false
    camera = '/dev/video0'
    format = 'v4l2'
    size = "1920x1080"
    fps = 30
    
    # Input parameters for the recording
    # Put flags that must come before `-i <camera name>` here.
    inputParameters = '-rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: copy H.264 stream directly (camera outputs H.264)
    # Put flags that must come after `-i <camera name>` here.
    outputParameters = '-c:v copy -an'
    
    # No recoding needed - camera already outputs H.264
    recode = false


[linux2]
    description = "HDMI Camera with AMD GPU"
    enabled = false
    camera = '/dev/video2' # Video device (must be even-numbered, e.g., /dev/video2)
    format = 'v4l2'
    size = "1920x1080"
    fps = 60
    
    # These input parameters initialize VAAPI and prevent the real-time buffer too full error.
    # They must be on the input side (before -i).
    inputParameters = '-hwaccel vaapi -vaapi_device /dev/dri/renderD128 -rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: produce H.264 output using VAAPI hardware encoder
    outputParameters = '-c:v h264_vaapi -rc_mode CBR -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'
    
    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false

[linux3]
    description = "HDMI Camera with NVIDIA GPU"
    enabled = false
    camera = '/dev/video4' # Video device (must be even-numbered, e.g., /dev/video4)
    format = 'v4l2'
    size = "1920x1080"
    fps = 60
    
    # These input parameters prevent the real-time buffer too full error.
    # They must be on the input side (before -i).
    inputParameters = '-rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: produce H.264 output using NVIDIA hardware encoder
    outputParameters = '-c:v h264_nvenc -preset p5 -rc cbr -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'
    
    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false

[linux4]
    description = "HDMI Camera with Intel GPU"
    enabled = false
    camera = '/dev/video6' # Video device (must be even-numbered, e.g., /dev/video6)
    format = 'v4l2'
    size = "1920x1080"
    fps = 60
    
    # These input parameters initialize the Intel hardware device and prevent the real-time buffer too full error.
    # QSV init must come first.
    inputParameters = '-init_hw_device qsv=hw -filter_hw_device hw -rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: produce H.264 output using Intel QSV hardware encoder
    outputParameters = '-c:v h264_qsv -preset medium -look_ahead 0 -rc_mode CBR -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'
    
    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false

# =======================================================
# Linux UDP Stream Configurations
# =======================================================
#
# These are usedd when the cameras are attached to other laptops on the
# network (for example, gaming laptops with GPU to encode MJPEG)

[linux5]
    description = "UDP Stream from Center Camera (Camera 1)"
    enabled = false
    camera = 'udp://239.255.0.1:9001'  # Multicast UDP stream from FFmpeg #1
    format = 'mpegts'
    size = "1920x1080"
    fps = 60
    
    # Input parameters: none needed - reading from multicast UDP stream
    inputParameters = ''
    
    # Output parameters: copy H.264 stream directly (already encoded by camera)
    outputParameters = '-c:v copy -an'
    
    # No recoding needed - stream is already H.264
    recode = false

[linux6]
    description = "UDP Stream from Side Camera (Camera 2)"
    enabled = false
    camera = 'udp://239.255.0.1:9002'  # Multicast UDP stream from FFmpeg #1
    format = 'mpegts'
    size = "1920x1080"
    fps = 60
    
    # Input parameters: none needed - reading from multicast UDP stream
    inputParameters = ''
    
    # Output parameters: copy H.264 stream directly (already encoded by camera)
    outputParameters = '-c:v copy -an'
    
    # No recoding needed - stream is already H.264
    recode = false

[linux7]
    description = "UDP Stream from Side Camera (Camera 3)"
    enabled = true
    camera = 'udp://239.255.0.1:9003'  # Multicast UDP stream from FFmpeg #1
    format = 'mpegts'
    size = "1920x1080"
    fps = 60
    
    # Input parameters: none needed - reading from multicast UDP stream
    inputParameters = ''
    
    # Output parameters: copy H.264 stream directly (encoded by FFmpeg #1)
    outputParameters = '-c:v copy -an'
    
    # No recoding needed - stream is already H.264
    recode = false
