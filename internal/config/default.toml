# HTTP server port
port = 8091

# address of owlcms.  a scan of the local network will be done if undefined or unreachable.
owlcms = ""

# Platform identifier if more than one platform detected
platform = "A"

# Directory to store video files (can be an absolute path to store on a different drive)
videoDir = 'videos'

# FFmpeg logging - set to true to create timestamped log files for ffmpeg output
logFfmpeg = false

# Use the `input_params` and `output_params` to manage your FFmpeg flags.
#
# A note on FFmpeg command order:
# [global flags] [input flags] -i <input_source> [output flags] <output_file>
#
# This configuration is designed to generate the command in the correct order.


# =======================================================
# Windows Camera Configurations
# =======================================================

# Webcam with software encoder
[windows1]
    enabled = true
    camera = 'Logitech Webcam C930e'
    format = 'dshow'
    size = "1280x720"
    fps = 30
    
    # Input parameters for the recording
    # Put flags that must come before `-i <camera name>` here.
    inputParameters = '-rtbufsize 512M -thread_queue_size 4096'

    # Output parameters: produce H.264 output using software encoder
    # Put flags that must come after `-i <camera name>` here.
    outputParameters = '-c:v libx264 -vf "format=yuv420p" -preset medium -b:v 4M -g 30 -keyint_min 30 -vsync cfr -an'
    
    # When trimming the video and packaging in mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false


# HDMI Camera with AMD GPU
[windows2]
    enabled = false
    camera = 'HDMI_AMD_GPU'
    format = 'dshow'
    size = "1920x1080"
    fps = 60
    
    # These input parameters prevent the real-time buffer too full error.
    # They must be on the input side (before -i).
    inputParameters = '-rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: produce H.264 output using AMD hardware encoder
    outputParameters = '-vaapi_device /dev/dri/renderD128 -c:v h264_vaapi -rc_mode CBR -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'

    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false

# HDMI Camera with NVIDIA GPU
[windows3]
    enabled = false
    camera = 'HDMI_NVIDIA_GPU'
    format = 'dshow'
    size = "1920x1080"
    fps = 60
    
    # These input parameters prevent the real-time buffer too full error.
    # They must be on the input side (before -i).
    inputParameters = '-rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: produce H.264 output using NVIDIA hardware encoder
    outputParameters = '-c:v h264_nvenc -preset p5 -rc cbr -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'

    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false

# HDMI Camera with Intel GPU
[windows4]
    enabled = false
    camera = 'HDMI_INTEL_GPU'
    format = 'dshow'
    size = "1920x1080"
    fps = 60
    
    # QSV init must come first, followed by input parameters
    inputParameters = '-init_hw_device qsv=hw -filter_hw_device hw -rtbufsize 512M -thread_queue_size 4096'

    # Output parameters: produce H.264 output using Intel QSV hardware encoder
    outputParameters = '-c:v h264_qsv -preset medium -look_ahead 0 -rc_mode CBR -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'

    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false


# =======================================================
# Linux Camera Configurations
# =======================================================

# Webcam with software encoder
[linux1]
    enabled = true
    camera = '/dev/video0'
    format = 'v4l2'
    size = "1280x720"
    fps = 30
    
    # Input parameters for the recording
    # Put flags that must come before `-i <camera name>` here.
    inputParameters = '-rtbufsize 512M -thread_queue_size 4096'

    # Output parameters: produce H.264 output using software encoder (Linux)
    # Put flags that must come after `-i <camera name>` here.
    outputParameters = '-c:v libx264 -vf "format=yuv420p" -preset medium -b:v 4M -g 30 -keyint_min 30 -vsync cfr -an'
    
    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false


# HDMI Camera with AMD GPU (Linux uses VAAPI, not AMF)
[linux2]
    enabled = false
    camera = '/dev/video2' # Video device (must be even-numbered, e.g., /dev/video2)
    format = 'v4l2'
    size = "1920x1080"
    fps = 60
    
    # These input parameters initialize VAAPI and prevent the real-time buffer too full error.
    # They must be on the input side (before -i).
    inputParameters = '-hwaccel vaapi -vaapi_device /dev/dri/renderD128 -rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: produce H.264 output using VAAPI hardware encoder
    outputParameters = '-c:v h264_vaapi -qp 23 -an'
    
    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false

# HDMI Camera with NVIDIA GPU
[linux3]
    enabled = false
    camera = '/dev/video4' # Video device (must be even-numbered, e.g., /dev/video4)
    format = 'v4l2'
    size = "1920x1080"
    fps = 60
    
    # These input parameters prevent the real-time buffer too full error.
    # They must be on the input side (before -i).
    inputParameters = '-rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: produce H.264 output using NVIDIA hardware encoder
    outputParameters = '-c:v h264_nvenc -preset p5 -rc cbr -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'
    
    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false

# HDMI Camera with Intel GPU
[linux4]
    enabled = false
    camera = '/dev/video6' # Video device (must be even-numbered, e.g., /dev/video6)
    format = 'v4l2'
    size = "1920x1080"
    fps = 60
    
    # These input parameters initialize the Intel hardware device and prevent the real-time buffer too full error.
    # QSV init must come first.
    inputParameters = '-init_hw_device qsv=hw -filter_hw_device hw -rtbufsize 512M -thread_queue_size 4096'
    
    # Output parameters: produce H.264 output using Intel QSV hardware encoder
    outputParameters = '-c:v h264_qsv -preset medium -look_ahead 0 -rc_mode CBR -b:v 8M -g 60 -keyint_min 60 -r 60 -vsync cfr -an'
    
    # When trimming the video and converting to mp4, we don't need to recode
    # because the output parameters from the recording are already in H.264 format
    recode = false
